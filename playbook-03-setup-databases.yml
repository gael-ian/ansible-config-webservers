---
# Setup and configure MySQL on databases servers
# 
# Use ansible-playbook without extra arguments:
# 
#     ansible-playbook playbook-03-setup-databases.yml
#
- name: Setup and configure MySQL on database servers
  remote_user: administrator
  become: yes
  
  # Configurations will be applied only on databases servers
  hosts: database_servers
  
  roles:
    # Install MySQL  
    # Disable external and anonymous connexions and set up  
    # MySQL root credentials (defined per server in `host_vars`).
    - mysql
    # Configure Monit to watch over MySQL services
    - {
        role: monit-service,
        monit_services: {
          mysql: { name: mysql, template: monit/mysql.j2 }
        }
      }

