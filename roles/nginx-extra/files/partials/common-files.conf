# Common configuration
# ====================

## If no favicon exists return a 204 (no content error).
location ~* ^(favicon\.ico|apple-touch-icon\.png)$ {
  
  try_files $uri =204;
  
  log_not_found off;
  access_log off;
  
  expires max;
  tcp_nodelay off;
  
  ## Set the OS file cache.
  open_file_cache max=1000 inactive=120s;
  open_file_cache_valid 45s;
  open_file_cache_min_uses 2;
  open_file_cache_errors off;
  
  add_header Cache-Control public;
  add_header Access-Control-Allow-Origin *;
  break;
}

## Don't log robots.txt requests.
location = /robots.txt {
  allow all;
  log_not_found off;
  access_log off;
}

# Deny all attempts to access hidden files such as .htaccess, .htpasswd, .DS_Store (Mac).
location ~ /\. {
  deny all;
  access_log off;
  log_not_found off;
}

# Stop execution on unused extensions
location ~ \.(aspx|jsp|cgi)$ {
  log_not_found off;
  access_log off;
  
  # http://httpstatus.es/444 : The server returns no information to the client and closes the connection
  return 444;
}
